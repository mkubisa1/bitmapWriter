bmpWriter is a Powershell script I made as a test while working on a different project (modified slightly for public release). The goal was to programatically generate a bitmap image which uses few colors, which could easily be customized to preview different color palettes. When called, the script generates the image, opens the preview, then deletes it when the user gives the OK.

The script generates this image in .BMP format:

![The image generated by the script](https://msk2k1.neocities.org/media/bmpWriter-github/reference.png)

# Getting Image Data
The very long "pixels" string in the script is like a template which represents each pixel as a single character, whose value depends on its color in the reference image. Generating the 24-bit bitmap output required knowledge of the .BMP format spec. [This article](https://lmcnulty.me/words/bmp-output/) was invaluable in understanding this. After the header, each pixel of the bitmap is represented as a three-byte RGB value of the corresponding color (Although the values are reversed, so really it's a "BGR" representation). I used [this hex editor](https://hexed.it/) to export the hex values to plaintext.

I wrote the addspace.ps1 helper script to help generate the string for the final "pixels" variable. This takes the string of hex characters from the editor and divides it into 32 rows of 16 three-byte hex colors, matching the dimensions of the final image. Then I simply opened the reference image in Microsoft Paint, used that to get the hex value for each color, and used a text editor to replace each color with a single letter (Again, the order of the red, green, and blue bytes is reversed from the standard hex color representation). Finally I removed all spaces and line breaks to get the final string.

Aside from the reversed "BGR" color values, the .BMP spec also orders the pixels starting from the bottom and working upwards. I thought it was interesting that, while replacing characters in the text editor, I could make out an upside-down "ASCII art" of the image I was making: (You may need to blur your vision to see this)

![The string representation of the reference image, with line breaks such that it roughly resembles the original image](https://msk2k1.neocities.org/media/bmpWriter-github/letters.png)

# Other Images
As written, this script is only capable of generating the one image. This data would need to be altered to have the script generate a different image:
* RGB color variables at the top of the script. (One for each color)
* The file header. It may be advantageous to simply copy the bytes from your desired reference image, rather than try to derive it manually.
* The "pixels" string.
* Add cases in the switch statement for each new color variable.

One can alter the color values at the top of the script, to change what colors it uses.